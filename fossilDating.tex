\documentclass[11pt]{article}

\usepackage{graphicx}
\usepackage{hyperref}
\usepackage[style=authoryear,backend=biber,mincitenames=1,maxcitenames=2, uniquelist=false]{biblatex}
\bibliography{fossilDating.bib}


\newcommand{\Mstrict}{{M1}}
\newcommand{\Mrelaxed}{{M8}}

\begin{document}

\title{Estimating the phylogenetic age of a fossil}
\author{Alexei Drummond, Tanja Stadler}
\date{\today{}}
\maketitle

\section*{Introduction}

% Papers
% http://www.ncbi.nlm.nih.gov/pmc/articles/PMC4033271/ Beyond fossil calibrations: realities of molecular clock practices in evolutionary biology
% http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0066245 A Simple Method for Estimating Informative Node Age Priors for the Fossil Calibration of Molecular Divergence Time Analyses
% http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3108556/  Bayesian Phylogenetic Method to Estimate Unknown Sequence Ages

Although there has been much controversy surrounding apparent discrepancies between palaeontological data and molecular phylogenetic inferences it is clear that fossil and molecular data both produce broadly concordant views of evolutionary history\footnote{For example see \url{http://www.actionbioscience.org/evolution/benton.html}}. Nevertheless there have been only few attempts to apply phylogenetic reasoning to palaeontological questions. In particular, although models of molecular evolution have been refined over many decades \autocite{Felsenstein2004,Yang:2006yu} there has been little change in the modelling of fossil data until very recently. One of the first examples of endeavouring to apply an evolutionary model to perform inference on the fossil record in fact demonstrated concordance between inferences from  molecular data and paleontological data \autocite{tavare2002using}. 

Traditionally the practice has been to use fossils from radiometrically-dated strata as ``node calibrations'' by associated their geologically-derived age to a particular divergence in a molecular phylogeny. This node calibration then confers age estimates to the remaining divergences on a phylogenetic tree by the assumption of a strict or relaxed molecular clock \autocite{Thorne1998,thorne2005,yang2006,Drummond2006}. 
Here we instead focus on what phylogenetic inference techniques can tell us about the ``phylogenetic age'' of a fossil, based solely on its morphological characteristics.

\subsection*{Phylogenetic tip-dating}

The phylogenetic estimation of the age of a taxon based on its molecular sequence has been previously described \autocite{drummond2002computational,shapiro2011bayesian} and applied to both ancient subfossil remains and rapidly evolving viral taxa. For example, this technique has been successfully employed to estimate the age of human subfossil remains based on an ancient mitochondrial genome sequence \autocite{meyer2014mitochondrial}. The same technique has also been used to estimate the age of viral samples based on molecular sequence data \autocite[e.g.][]{gray2013evolutionary}.

We extend this work into the realm of morphological evolution by presenting a statistical model of evolution that generates an expectation on the distribution of fossils and their morphological characters. This model has been previously presented in the context of divergence time dating \autocite{gavr2014,gavryushkina2015bayesian}. It is distinct from alternative divergence time dating approaches in that is provides an explicit treatment of the temporal information contained in fossil remains, whether or not related molecular sequence data is available. This leads to an estimate of the age of the most recent common ancestor of a group of fossils. We exploit this framework to attempt the estimation of the phylogenetic age of individual fossils based solely on morphological data and their phylogenetic affinities to other fossils of known age. The method is applied to a rich and well-characterized morphological data set of extant penguins and their fossil ancestors.

\section*{Methods}

\textcite{gavryushkina2015bayesian} described a ``total-evidence'' approach to the phylogenetic estimation of time-trees that employed both fossil and molecular sequence data as equal partners under the rule of probability. We extend their work further by investigating the consistency between the estimated phylogenetic age of a fossil and the corresponding palaeontological age range based on radiometrically-dated geological strata. The model of time-tree phylogeny employed is the so-called fossilized birth-death process \autocite{Heath2014}, which forms a prior probability distribution on the space of sampled-ancestor trees \autocite{Gavr2013}.

A previous study described how a set of fossils with discrete morphological characters could be used to estimate a time-tree or chrono-phylogeny. Here we additionally allow for one or more of the fossils to have broad uninformative priors on their age. This allows for the age of some of the fossils to be estimated solely based on their morphological characters and the phylogenetic affinities of their morphology to other fossils with known ages in the time-tree. We refer to this estimate of a fossil's age as its {\em phylogenetic age}. In estimating each of the fossils' phylogenetic ages in turn, three questions can be answered: (i) How much information about an individual fossil's age is available from phylogenetic analysis of morphological data alone, (ii) What is the level of phylogenetic evidence in support of the palaeontological age range for a fossil, and (iii) How does the amount of morphological data available for a new fossil and the number of related reference fossils of known age effect the accuracy of the phylogenetic estimate of a fossil's age. These three questions are investigated in the context of a morphological data set of of 36 fossil penguins and their extant relatives \autocite{gavryushkina2015bayesian} (see Table \ref{fossilTable}).

\subsection*{Estimating the phylogenetic age of penguin fossils}

For each of the 36 penguin fossils in our data set in turn we performed a separate Bayesian phylogenetic analysis in which the focal fossil's palaeontological age constraints were replaced by a broad uniform prior of $(0,160)$ Mya. We chose 160 as the upper limit as we expect no serious argument that any bird fossil would be older than 160Mya and it also corresponds the upper limit on the origin of the whole phylogeny. For the choices of morphological substitution model and tree prior we followed \textcite{gavryushkina2015bayesian} and considered two alternative modelling combinations. The first was Model 1 in which a strict clock and the simplest model of morphological substitution was assumed \autocite{Lewis2001}. We also employed Model 8 from \textcite{gavryushkina2015bayesian} which involved a more complex model assuming a relaxed clock model \autocite{Drummond2006}, partitioning of the sites into groups of equal state count and an additional parameter for gamma-distributed rate variation across sites \autocite{yang:1994ma}.



\subsection*{Bayes factors}

The Bayes factor ($BF$) computes the evidence for one hypothesis ($H_1$) over another ($H_2$) as the ratio of the marginal probability of the data under each of the two hypotheses:

\begin{equation}
BF = \frac{\Pr\{D|H_1\}}{\Pr\{D|H_2\}} = \frac{p(H_1|D)}{p(H_2|D)}\frac{p(H_2)}{p(H_1)}
\end{equation}

We are interested in computing the Bayes factor that quantifies the amount of phylogenetic evidence in support of the geological age range for each fossil. In this case $H_1$ is the hypothesis that the true fossil age is within the given paleontological age range, and $H_2$ is the alternative hypothesis that the true fossil age is outside the geological range, but within the broader interval of $(0,160)$ Mya. So for each fossil the prior probability of $H_1$, $p(H_1)$, is easily computed as the width of the geological range divided by 160 and the prior probability of the alternative is simply $p(H_2) = 1 - p(H_1)$. We assume a prior probability of zero that the fossil age is older than 160Mya. Likewise $p(H_1 | D)$ is the posterior probability that the age falls in the geological range and $p(H_2 | D) = 1 - p(H_1 | D)$. Thus computing the Bayes factor in this instance is easy to do for each fossil once a posterior distribution of the phylogenetic age of the fossil is obtained under a Uniform prior from $(0,160)$ Mya.

\section*{Results}


\subsection*{\Mstrict{}: Strict clock model, no rate variation among sites}
Although \Mstrict{} is very simple model, the phylogenetic age estimates for the penguin fossils were remarkably consistent with their palaeontological age ranges. Figure \ref{fig:phyloAgeVsGeoAge} plots the geological age and range against the phylogenetic age estimates. The points in this plot have $R^2 = 0.9$. The median error (difference between the phylogenetic median and the geological median) is 2.0 Myr.

As judged by Bayes factors, none of the fossils showed evidence that the phylogenetic age was inconsistent with the geological age range if we took into account the prior probability of the geological range in the context of a uniform prior from $(0,160)$ Mya. However if we consider only the posterior probability that the fossil is in the geological age range then three of the 36 fossils has a posterior probability $< 0.05$, suggesting low posterior support for the phylogenetic age being within the palaeontological age range. These three fossils were {\em Madrynornis mirandus}, {\em Paraptenodytes antarcticus} and {\em Sphenicus muizoni} with posterior probabilities that the phylogenetic age is in the palaeontological range of 0.017, 0.0035 and 0.0027 respectively. All other fossils has posterior probabilities of $> 0.05$ of their age being in the palaeontological range. It is worth noting that the absolute discrepancy in the ages are still quite moderate for the three fossils with low posterior probabilities, with {\em M. mirandus}: 6.6Myr vs 10Myr (phylogenetic age versus palaeontological age), {\em P. antarcticus}: 29.8 vs 22, {\em S. muizoni}: 5.0 vs 9.1. The small posterior probabilities are partially caused in these cases because the corresponding palaeontological age range is narrow, suggesting very precise geological knowledge of the ages of these three fossils.

\subsection*{\Mrelaxed{}: Relaxed clock, site partitions, rate variation among sites}

\Mrelaxed{} was the best-fitting model according to the analysis of \textcite{gavryushkina2015bayesian}. As with \Mstrict{} this model produced phylogenetic age estimates that were very concordant with the geological age ranges of the fossils. The median error was 2.1 Myr across all 36 fossils. All Bayes factors supported the geological age range above the hypothesis of outside the geological age range.

\begin{figure}
\includegraphics[width=5in]{run8_5/8_phyloAgeVsGeoAge.pdf}
\caption{\label{fig:phyloAgeVsGeoAge}
The Bayesian phylogenetic age estimate (median of marginal posterior) for each of the 36 penguin fossils plotted against their palaeontological age estimates. The palaeontological age estimates are represented by the mid-point of the range and the upper and lower limits. The Bayesian estimates are represented by the median of the marginal posterior distribution and the upper and lower limits of the 95\% HPD interval. Blue line shows the $x=y$. If the vertical line doesn't cross $x=y$, then the midpoint of the geological range is not in the phylogenetic 95\% HPD. If the horizontal line doesn't cross $x=y$, then the median phylogenetic estimate is not contained in the palaeontological age range. The three labelled fossils show significant inconsistency.}
\end{figure}

\begin{figure}
\includegraphics[width=5in]{run8_5/8_precisionVsKnownCharacters.pdf}
\caption{A plot of the number of non-ambiguous morphological sites for the taxon against the precision of its phylogenetic age (i.e. the precisions is 1/variance in the marginal posterior distribution of the age).}
\end{figure}

\begin{figure}
\includegraphics[width=6in]{run8_5/fossilDatingDensities_younger.pdf}
\caption{Marginal posterior density plots for the phylogenetic age estimate of each of the 18 penguin fossils younger than 30 Myr. Red boxes are the superimposed age ranges derived from geological data.}
\end{figure}

\begin{figure}
\includegraphics[width=6in]{run8_3/fossilDatingDensities_older.pdf}
\caption{Marginal posterior density plots for the phylogenetic age estimate of each of the 18 penguin fossils older than 30 Myr. Red boxes are the superimposed age ranges derived from geological data.}
\end{figure}

\input{run8_5/8_summaryTable.tex}

\section*{Discussion}

In this paper we have demonstrated that even a small number of morphological characters (some of the fossils had as few as 7 morphological traits coded) can be used in the context of a rich fossil reference data set, to provide an accurate and precise age of the fossil based on a phylogenetic model. The median error in age estimates for the penguin data set we analysed here was 2 My, using either a very simple or a more complex model of morphological change. In both cases we used the new fossilized birth-death tree prior, which is a crucial ingredient in allowing for the estimating of fossil ages under a birth-death tree prior.

\printbibliography


\end{document}
