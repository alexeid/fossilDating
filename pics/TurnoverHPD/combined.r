tipsFos <- c(110,22,35,30,19,71,32,13,14,54,139,123,18,104,93,4,112,43,9,38,163,45,31,127,41,14,23,9,56,69,86,6,22,23,22,17,10,27,61,112,56,53,132,74,12,8,27,5,108,39,21,96,12,42,18,6,21,45,95,118,91,28,69,122,117,82,12,36,51,33,35,44,22,119,25,31,80,63,14,5,45,155,28,15,75,5,26,11,35,49,93,146,23,155,30,5,80)
meanturnoverFos1 <- c(0.237753,0.282807,0.406237,0.325908,0.318481,0.482941,0.441836,0.388898,0.316985,0.411895,0.339383,0.282116,0.354442,0.302688,0.298226,0.387423,0.162655,0.250391,0.311645,0.400448,0.322474,0.305538,0.283538,0.264003,0.491897,0.317938,0.401526,0.387903,0.450142,0.498687,0.361352,0.474671,0.381083,0.562027,0.258626,0.516092,0.516234,0.255333,0.383665,0.407373,0.237667,0.408168,0.190386,0.343227,0.36504,0.635617,0.446687,0.510821,0.373153,0.390367,0.5032,0.287836,0.341761,0.349008,0.256275,0.495444,0.234588,0.449309,0.266914,0.32554,0.43248,0.463163,0.287841,0.265211,0.235868,0.308995,0.499442,0.356889,0.277843,0.26912,0.469959,0.286075,0.450844,0.403487,0.299836,0.245508,0.235599,0.326164,0.422383,0.456544,0.443678,0.308638,0.478939,0.347856,0.406673,0.270111,0.430847,0.456058,0.580468,0.356516,0.168834,0.318948,0.362852,0.34897,0.347366,0.262352,0.255882)
medturnoverFos1 <- c(0.231028,0.258341,0.395217,0.309177,0.292445,0.48173,0.445636,0.364586,0.283872,0.412528,0.338934,0.274331,0.333235,0.296221,0.287584,0.360219,0.143917,0.229045,0.274137,0.396231,0.318804,0.286815,0.251065,0.257935,0.489153,0.276711,0.382014,0.360715,0.450741,0.494936,0.365521,0.474823,0.361437,0.567079,0.226177,0.518078,0.518232,0.228592,0.376492,0.402185,0.218787,0.401209,0.176694,0.335344,0.329216,0.658785,0.443233,0.514855,0.368543,0.381147,0.512778,0.277829,0.303884,0.332884,0.214965,0.493078,0.199588,0.449447,0.257949,0.324279,0.431704,0.46018,0.275076,0.255452,0.227139,0.299345,0.502947,0.337669,0.259289,0.246656,0.467175,0.27278,0.444214,0.400077,0.271488,0.220567,0.221045,0.311434,0.41091,0.446593,0.438129,0.30612,0.479607,0.323743,0.401463,0.205085,0.425193,0.448982,0.592667,0.339338,0.149923,0.317086,0.345637,0.345883,0.322782,0.207417,0.243227)
lowturnoverFos1 <- c(0.037808,0.00812,0.055874,0.039455,0.011681,0.202784,0.100382,0.029297,0.030036,0.111071,0.100552,0.085887,0.041801,0.058859,0.080381,0.001298,0.006639,0.030263,0.006257,0.053244,0.129721,0.025785,0.006473,0.063197,0.18212,0.006509,0.060449,0.032661,0.103243,0.232797,0.098171,0.07278,0.063423,0.21652,0.005902,0.138853,0.140518,0.006803,0.114828,0.195833,0.027449,0.136322,0.029727,0.107505,0.014358,0.256849,0.118597,0.107705,0.141049,0.068441,0.084011,0.04665,0.005584,0.07051,0.00474,0.082609,0.010097,0.143081,0.051299,0.086139,0.185816,0.116927,0.051169,0.057937,0.057009,0.075516,0.109031,0.028036,0.046072,0.002425,0.135546,0.035596,0.100434,0.202377,0.012587,0.007167,0.02758,0.087238,0.04125,0.05781,0.094081,0.106331,0.09022,0.022434,0.158636,7.23E-5,0.084136,0.06638,0.263405,0.083799,0.004404,0.125343,0.045436,0.159032,0.037515,2.29E-5,0.038548)
highturnoverFos1 <- c(0.437443,0.624388,0.765039,0.634993,0.670588,0.731256,0.779357,0.781646,0.701855,0.71868,0.557749,0.494146,0.735533,0.540003,0.508331,0.821521,0.346039,0.536229,0.726472,0.703885,0.526483,0.601522,0.622217,0.468795,0.77813,0.71812,0.758705,0.794158,0.755509,0.740823,0.604618,0.866206,0.776014,0.899268,0.598092,0.883201,0.918612,0.566277,0.635272,0.641387,0.493716,0.692932,0.38213,0.603883,0.782259,0.969876,0.835856,0.93934,0.589325,0.698062,0.861204,0.519945,0.731547,0.648737,0.602991,0.892226,0.553336,0.749486,0.50638,0.547238,0.658911,0.811827,0.535676,0.484922,0.456217,0.563572,0.896334,0.68811,0.562844,0.570814,0.779553,0.552821,0.835815,0.634255,0.645142,0.521579,0.450121,0.575543,0.836335,0.862894,0.742889,0.518882,0.837825,0.724129,0.67142,0.740378,0.795386,0.8385,0.883549,0.675365,0.354708,0.512044,0.714508,0.544276,0.683153,0.705713,0.503806)
trueturnoverFos1 <- c(0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5)
meanturnoverFos <- meanturnoverFos1[tipsFos>5]
medturnoverFos <- medturnoverFos1[tipsFos>5]
lowturnoverFos <- lowturnoverFos1[tipsFos>5]
highturnoverFos <- highturnoverFos1[tipsFos>5]
trueturnoverFos <- trueturnoverFos1[tipsFos>5]
errturnoverFos <- abs(medturnoverFos - trueturnoverFos)/trueturnoverFos
biasturnoverFos <- (medturnoverFos - trueturnoverFos)/trueturnoverFos
widthturnoverFos <- (highturnoverFos - lowturnoverFos)/trueturnoverFos
accurturnoverFos <- lowturnoverFos <= trueturnoverFos & highturnoverFos >= trueturnoverFos
round(median(meanturnoverFos), 4)
round(median(medturnoverFos), 4)
round(median(errturnoverFos), 4)
round(median(biasturnoverFos), 4)
round(median(widthturnoverFos), 4)
sum(accurturnoverFos == TRUE)
length(trueturnoverFos)
round(100*sum(accurturnoverFos == TRUE)/length(trueturnoverFos), 0)
tipsFos <- tipsFos[tipsFos>5]
mean(tipsFos)

#replace from here

meanturnover <- c(0.276844,0.312602,0.346944,0.33643,0.35552,0.394651,0.290158,0.399869,0.387874,0.286223,0.33653,0.264132,0.461343,0.314526,0.27107,0.276862,0.313828,0.428687,0.456098,0.329888,0.27644,0.368204,0.227332,0.522186,0.286164,0.566812,0.481314,0.417767,0.48322,0.273657,0.520621,0.356234,0.598567,0.348842,0.515163,0.37973,0.396645,0.332772,0.410211,0.281639,0.339051,0.243178,0.425643,0.347213,0.451823,0.44116,0.257894,0.315087,0.374446,0.3946,0.399414,0.376413,0.270996,0.488834,0.280458,0.397989,0.325181,0.251026,0.343214,0.447624,0.372316,0.245607,0.256564,0.352532,0.467237,0.394855,0.357049,0.360615,0.411255,0.262298,0.53067,0.257299,0.417894,0.298621,0.300865,0.334719,0.407305,0.449347,0.309109,0.498639,0.404115,0.375653,0.503476,0.45364,0.609983,0.347614,0.32604,0.313242,0.332045,0.294847,0.4118,0.263281)
length(meanturnover)
medturnover <- c(0.260766,0.269495,0.321889,0.308612,0.331509,0.389794,0.263739,0.368672,0.364974,0.260572,0.331792,0.247664,0.445411,0.30027,0.250386,0.261189,0.291309,0.408013,0.454108,0.326104,0.246548,0.347463,0.208824,0.53246,0.236089,0.582946,0.483705,0.412414,0.490552,0.254195,0.523642,0.333436,0.624913,0.320132,0.517656,0.346461,0.377212,0.315165,0.413448,0.257786,0.319048,0.227253,0.424004,0.30896,0.442566,0.43707,0.240542,0.289355,0.351994,0.388197,0.371746,0.360748,0.221888,0.486106,0.24028,0.384638,0.313148,0.233197,0.334183,0.442857,0.359842,0.227811,0.240792,0.337444,0.456517,0.379402,0.340685,0.339709,0.401362,0.23816,0.54314,0.241809,0.403721,0.269862,0.283324,0.318774,0.384709,0.444959,0.297029,0.505915,0.38471,0.368359,0.50548,0.439107,0.633863,0.334807,0.312423,0.307582,0.305215,0.286696,0.398081,0.244521)
lowturnover <- c(0.020198,0.004223,0.015883,0.018507,0.020833,0.056785,0.008652,0.029159,0.034895,0.016643,0.05781,0.017489,0.090808,0.027597,0.014551,0.017834,0.008075,0.04923,0.067471,0.048531,0.01326,0.030383,0.011217,0.128625,0.001521,0.180826,0.058902,0.045872,0.137216,0.020606,0.13625,0.024363,0.200833,0.009847,0.143636,0.013053,0.038388,0.033749,0.091601,0.016881,0.028547,0.015801,0.070142,0.009978,0.041198,0.058215,0.017002,0.017802,0.03535,0.048806,0.021424,0.035691,0.003994,0.066386,0.006909,0.036007,0.036618,0.016457,0.039951,0.055629,0.043529,0.014022,0.012624,0.037528,0.059873,0.050631,0.035779,0.017627,0.050375,0.005791,0.138297,0.023032,0.034696,0.015324,0.016421,0.031886,0.025558,0.071305,0.030578,0.098541,0.034219,0.048518,0.085957,0.038441,0.223195,0.038218,0.035676,0.03942,0.009803,0.038102,0.04658,0.011941)
highturnover <- c(0.554594,0.711492,0.723763,0.691538,0.731067,0.730043,0.621026,0.812488,0.797605,0.614494,0.633184,0.529472,0.891944,0.615064,0.563475,0.546177,0.645446,0.830576,0.82054,0.596585,0.61816,0.745743,0.468643,0.884864,0.699601,0.948461,0.86739,0.773122,0.826698,0.564141,0.943838,0.757314,0.97117,0.732092,0.910804,0.788727,0.79263,0.65857,0.716562,0.591011,0.678439,0.496321,0.745098,0.764974,0.854263,0.831187,0.523177,0.651548,0.7835,0.715995,0.816979,0.733971,0.658956,0.905042,0.6529,0.752904,0.629551,0.515927,0.637007,0.833134,0.699843,0.502383,0.520882,0.687509,0.870199,0.785859,0.70351,0.723087,0.78173,0.555589,0.926802,0.516466,0.801442,0.650373,0.598642,0.656596,0.80973,0.818567,0.599067,0.884696,0.796493,0.683113,0.882918,0.851726,0.956624,0.696578,0.634561,0.577812,0.71705,0.562499,0.804718,0.537539)
trueturnover <- c(0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5,0.5/1.5)
errturnover <- abs(medturnover - trueturnover)/trueturnover
biasturnover <- (medturnover - trueturnover)/trueturnover
widthturnover <- (highturnover - lowturnover)/trueturnover
accurturnover <- lowturnover <= trueturnover & highturnover >= trueturnover

tips <- c(110,22,35,30,19,71,32,13,14,54,139,123,18,104,93,112,43,9,38,163,45,31,127,41,14,23,9,56,69,86,6,22,23,22,17,10,27,61,112,56,53,132,74,12,8,27,108,39,21,96,12,42,18,6,21,45,95,118,91,28,69,122,117,82,12,36,51,33,35,44,22,119,25,31,80,63,14,45,155,28,15,75,26,11,35,49,93,146,23,155,30,80)

#to here

dev.new(width=5, height=5.5)

#par(mfrow=c(1,2), mar=c(5,4,3,1))

xmin <- min(tips, tipsFos[tipsFos>5])
xmax <- max(tips, tipsFos[tipsFos>5])
ymin <- min(widthturnover, widthturnoverFos)
ymax <- max(widthturnover, widthturnoverFos)

plot(tipsFos, widthturnoverFos, xlim=c(xmin, xmax), ylim=c(ymin, ymax), xlab="Number of sampled nodes", ylab="Relative 95% HPD widths", main="Turnover rate", pch=20, col="white")

#segments(tipsFos, widthturnoverFos, tipsFos, widthturnover, col="grey90", lwd=2) #col=rgb(1, 0, 0, 0.5)
points(tips, widthturnover, col="indianred",pch=17)

points(tipsFos, widthturnoverFos, pch=16)

legend(75,2.5, c("all sequence data","extant sequences only"), pch=c(16,17),col=c("black","indianred"))

#segments(tipsFos, widthturnoverFos, tips, widthturnover, col='red', lwd=2)
